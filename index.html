
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Documentation</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen-69ce25e5.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-bccf8c07.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-41f7362e.js"></script>
  </head>

  <body class="index" data-languages="[&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <a href="https://kickmybot.com">
        <img src="images/logo-24ff514d.png" class="logo" alt="Logo" />
      </a>
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#base-setup" class="toc-h1 toc-link" data-title="Base Setup">Base Setup</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#indexes-names" class="toc-h2 toc-link" data-title="Indexes names">Indexes names</a>
                  </li>
                  <li>
                    <a href="#fields-names" class="toc-h2 toc-link" data-title="Fields names">Fields names</a>
                  </li>
                  <li>
                    <a href="#basic-structure" class="toc-h2 toc-link" data-title="Basic structure">Basic structure</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#terms-structure" class="toc-h1 toc-link" data-title="Terms structure">Terms structure</a>
          </li>
          <li>
            <a href="#terms-examples" class="toc-h1 toc-link" data-title="Terms examples">Terms examples</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#basic-numeric-field" class="toc-h2 toc-link" data-title="Basic numeric field">Basic numeric field</a>
                  </li>
                  <li>
                    <a href="#basic-string-field" class="toc-h2 toc-link" data-title="Basic string field">Basic string field</a>
                  </li>
                  <li>
                    <a href="#basic-array-of-string" class="toc-h2 toc-link" data-title="Basic array of string">Basic array of string</a>
                  </li>
                  <li>
                    <a href="#basic-array-of-string-default-value" class="toc-h2 toc-link" data-title="Basic array of string + default value">Basic array of string + default value</a>
                  </li>
                  <li>
                    <a href="#array-of-string-default-values" class="toc-h2 toc-link" data-title="Array of string + default values">Array of string + default values</a>
                  </li>
                  <li>
                    <a href="#array-of-string-advanced-default-values" class="toc-h2 toc-link" data-title="Array of string + advanced default values">Array of string + advanced default values</a>
                  </li>
                  <li>
                    <a href="#advanced-example" class="toc-h2 toc-link" data-title="Advanced example">Advanced example</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#from-and-size" class="toc-h1 toc-link" data-title="From and size">From and size</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#script-parameter" class="toc-h2 toc-link" data-title="Script parameter">Script parameter</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#location" class="toc-h1 toc-link" data-title="Location">Location</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#basic-structure-2" class="toc-h2 toc-link" data-title="Basic structure">Basic structure</a>
                  </li>
                  <li>
                    <a href="#gauss-parameter" class="toc-h2 toc-link" data-title="Gauss parameter">Gauss parameter</a>
                  </li>
                  <li>
                    <a href="#travel-time" class="toc-h2 toc-link" data-title="Travel time">Travel time</a>
                  </li>
                  <li>
                    <a href="#starting-coordinates" class="toc-h2 toc-link" data-title="Starting coordinates">Starting coordinates</a>
                  </li>
                  <li>
                    <a href="#starting-city" class="toc-h2 toc-link" data-title="Starting city">Starting city</a>
                  </li>
                  <li>
                    <a href="#bound-box" class="toc-h2 toc-link" data-title="Bound box">Bound box</a>
                  </li>
                  <li>
                    <a href="#polygons" class="toc-h2 toc-link" data-title="Polygons">Polygons</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#associations" class="toc-h1 toc-link" data-title="Associations">Associations</a>
          </li>
          <li>
            <a href="#synonyms" class="toc-h1 toc-link" data-title="Synonyms">Synonyms</a>
          </li>
          <li>
            <a href="#settings" class="toc-h1 toc-link" data-title="Settings">Settings</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#filters" class="toc-h2 toc-link" data-title="Filters">Filters</a>
                  </li>
                  <li>
                    <a href="#analyzer" class="toc-h2 toc-link" data-title="Analyzer">Analyzer</a>
                  </li>
                  <li>
                    <a href="#synonyms-2" class="toc-h2 toc-link" data-title="Synonyms">Synonyms</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#schema" class="toc-h1 toc-link" data-title="Schema">Schema</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#general-structure" class="toc-h2 toc-link" data-title="General structure">General structure</a>
                  </li>
                  <li>
                    <a href="#api-fw-architecture" class="toc-h2 toc-link" data-title="API FW architecture">API FW architecture</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#api-gateway" class="toc-h1 toc-link" data-title="API Gateway">API Gateway</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#api-gateway-architecture" class="toc-h2 toc-link" data-title="API Gateway architecture">API Gateway architecture</a>
                  </li>
                  <li>
                    <a href="#method-request" class="toc-h2 toc-link" data-title="Method Request">Method Request</a>
                  </li>
                  <li>
                    <a href="#integration-request" class="toc-h2 toc-link" data-title="Integration Request">Integration Request</a>
                  </li>
                  <li>
                    <a href="#method-responses" class="toc-h2 toc-link" data-title="Method Responses">Method Responses</a>
                  </li>
                  <li>
                    <a href="#integration-responses" class="toc-h2 toc-link" data-title="Integration Responses">Integration Responses</a>
                  </li>
              </ul>
          </li>
      </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<ul>
<li>The great principales to build a new API:

<ul>
<li>create the indexation to understand the data

<ul>
<li>fetch the data</li>
<li>analyse the content</li>
<li>create fields</li>
</ul></li>
<li>create search and transcribe functions

<ul>
<li>create the config to fit API needs

<ul>
<li>create esParameters mappings</li>
<li>select fields that can be used as strict match(terms)</li>
</ul></li>
<li>call functions from FW with the config in parameter</li>
</ul></li>
</ul></li>
<li>create the API and the API keys + link endpoints to API lambdas</li>
<li>create Postman monitor if needed</li>
</ul>
<h1 id='base-setup'>Base Setup</h1><h2 id='indexes-names'>Indexes names</h2>
<p>First, the indexes names need to be set:</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">tablesNamesES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">properties</span><span class="p">:</span> <span class="s2">"biens"</span>
<span class="p">}</span>
</code></pre><h2 id='fields-names'>Fields names</h2><pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esParameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">keywords</span><span class="p">:</span> <span class="s2">"mots_cles"</span><span class="p">,</span>
    <span class="na">location</span><span class="p">:</span> <span class="s2">"localisation"</span>
<span class="p">}</span>
</code></pre><h2 id='basic-structure'>Basic structure</h2>
<p>All the config is dedicated to a specific index, and the index name is got from <code>tablesNamesES</code> object:</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="na">FIELD_NAME</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="p">...</span> <span class="p">],</span>
            <span class="na">defaultValue</span><span class="p">:</span> <span class="p">...,</span>
            <span class="na">options</span><span class="p">:</span> <span class="p">{</span> <span class="p">...</span> <span class="p">},</span>
            <span class="na">min</span><span class="p">:</span> <span class="p">...,</span>
            <span class="na">max</span><span class="p">:</span> <span class="p">...,</span>
            <span class="na">correctParameters</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">ATTRIBUTE</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="p">...</span> <span class="p">],</span>
                    <span class="na">correctValues</span><span class="p">:</span> <span class="p">[</span> <span class="p">...</span> <span class="p">],</span>
                    <span class="na">defaultValue</span><span class="p">:</span> <span class="p">...,</span>
                    <span class="na">options</span><span class="p">:</span> <span class="p">{</span> <span class="p">...</span> <span class="p">},</span>
                    <span class="na">min</span><span class="p">:</span> <span class="p">...,</span>
                    <span class="na">max</span><span class="p">:</span> <span class="p">...,</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p><code>ATTRIBUTE</code> is the attribute that can be passed to the <code>FIELD_NAME</code>.</p>

<p>For example, <code>FIELD_NAME</code> can be:
- <code>keywords</code>
- <code>terms</code>
- <code>subfields</code>
- <code>location</code></p>

<p><code>correctParameters</code> is used for objects fields.</p>

<p><code>correctTypes</code> is used for the values type, it can be one of the following:</p>

<ul>
<li><code>boolean</code></li>
<li><code>string</code></li>
<li><code>number</code></li>
<li><code>object</code></li>
<li><code>array</code></li>
</ul>

<p><code>min</code> and <code>max</code> options are used for <code>number</code> values.</p>

<p>If <code>array</code> is selected, it will check if all the array items fit the other types requirements.</p>

<p><code>terms</code> is used for match against data fields (for example here <code>status</code>, or <code>price</code>).</p>

<p>Instead of using directly a name like <code>&quot;location&quot;</code>, please use <code>[esParameters.location]</code> as key for the config, in order to handle translations and renaming.</p>
<h1 id='terms-structure'>Terms structure</h1>
<p>The <code>terms</code> config is used for queries agains data fields.</p>

<p><code>keys</code> will contain each field that can be used as queries.</p>

<p><code>options</code> will contain all fields options for specific use.</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="na">terms</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">keys</span><span class="p">:</span> <span class="p">[</span> <span class="p">...</span> <span class="p">],</span>
            <span class="na">options</span><span class="p">:</span> <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>At the root object, we can the option <code>mustBetweenTerms: true</code> to add a must between queries, if multiple queries are passed.</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="na">terms</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">mustBetweenTerms</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">keys</span><span class="p">:</span> <span class="p">[</span> <span class="p">...</span> <span class="p">],</span>
            <span class="na">options</span><span class="p">:</span> <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><h1 id='terms-examples'>Terms examples</h1><h2 id='basic-numeric-field'>Basic numeric field</h2>
<p>To initialize a numeric field:</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="na">terms</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">keys</span><span class="p">:</span> <span class="p">[</span> <span class="nx">esParameters</span><span class="p">.</span><span class="nx">price</span> <span class="p">],</span>
            <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
                <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">price</span><span class="p">]:</span> <span class="p">{</span>
                    <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"numbers"</span><span class="p">,</span> <span class="s2">"string"</span> <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>We can send a query like:</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">price</span><span class="p">:</span> <span class="mi">100000</span>
<span class="p">}</span>
</code></pre>
<p>And get all the data where <code>status</code> is equal to <code>Available</code>.</p>

<p>The <code>options</code> object will specify <strong>exact match</strong> for data result (needed with string queries).</p>

<p>As numeric field, we can send min / max objects:</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">price</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">min</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
        <span class="nx">max</span><span class="p">:</span> <span class="mi">200000</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><h2 id='basic-string-field'>Basic string field</h2>
<p>To initialize a string field for exact match:</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="na">terms</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">keys</span><span class="p">:</span> <span class="p">[</span> <span class="nx">esParameters</span><span class="p">.</span><span class="nx">status</span> <span class="p">],</span>
            <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
                <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">status</span><span class="p">]:</span> <span class="p">{</span>
                    <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span> <span class="p">],</span>
                    <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
                        <span class="na">strict</span><span class="p">:</span> <span class="kc">true</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>We can send a query like:</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">status</span><span class="p">:</span> <span class="s2">"Active"</span>
<span class="p">}</span>
</code></pre>
<p>And get all the data where <code>status</code> is equal to <code>Available</code>.</p>

<p>The <code>options</code> object will specify <strong>exact match</strong> for data result (needed with string queries).</p>
<h2 id='basic-array-of-string'>Basic array of string</h2>
<p>To allow arrays of string, we just need to add &quot;array&quot; in correctTypes.</p>

<p><em>(OR condition will be used and test if each element is one of the correctTypes)</em></p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
   <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="na">terms</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">keys</span><span class="p">:</span> <span class="p">[</span> <span class="nx">esParameters</span><span class="p">.</span><span class="nx">status</span> <span class="p">],</span>
            <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
                <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">status</span><span class="p">]:</span> <span class="p">{</span>
                    <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span><span class="p">,</span> <span class="s2">"array"</span> <span class="p">],</span>
                    <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
                        <span class="na">strict</span><span class="p">:</span> <span class="kc">true</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>We can send a query like:
<code>javascript
{
    status: [ &quot;Active&quot;, &quot;Available&quot; ]
}
</code>
And get all data where the status is <code>Active</code> <strong>OR</strong> <code>Available</code>.</p>
<h2 id='basic-array-of-string-default-value'>Basic array of string + default value</h2>
<p>Default values can be used in order to query specific items:</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="na">terms</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">keys</span><span class="p">:</span> <span class="p">[</span> <span class="nx">esParameters</span><span class="p">.</span><span class="nx">status</span> <span class="p">],</span>
            <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
                <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">status</span><span class="p">]:</span> <span class="p">{</span>
                    <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span><span class="p">,</span> <span class="s2">"array"</span> <span class="p">],</span>
                    <span class="na">defaultValue</span><span class="p">:</span> <span class="p">{</span>
                        <span class="na">value</span><span class="p">:</span> <span class="s2">"Available"</span>
                    <span class="p">},</span>
                    <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
                        <span class="na">strict</span><span class="p">:</span> <span class="kc">true</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>We can send an empty query, and get all data where the status is <code>Available</code>.</p>
<h2 id='array-of-string-default-values'>Array of string + default values</h2>
<p>Default values can be used in order to query specific items:</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="na">terms</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">keys</span><span class="p">:</span> <span class="p">[</span> <span class="nx">esParameters</span><span class="p">.</span><span class="nx">status</span> <span class="p">],</span>
            <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
                <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">status</span><span class="p">]:</span> <span class="p">{</span>
                    <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span><span class="p">,</span> <span class="s2">"array"</span> <span class="p">],</span>
                    <span class="na">defaultValue</span><span class="p">:</span> <span class="p">{</span>
                        <span class="na">value</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"Available"</span><span class="p">,</span> <span class="s2">"Active"</span> <span class="p">]</span>
                    <span class="p">},</span>
                    <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
                        <span class="na">strict</span><span class="p">:</span> <span class="kc">true</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>We can send an empty query, and get all data where the status is <code>Available</code> <strong>OR</strong> <code>Active</code>.</p>
<h2 id='array-of-string-advanced-default-values'>Array of string + advanced default values</h2>
<p>Default values can be set with options, such as <code>operand</code>, that will update the kind of query:</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="na">terms</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">keys</span><span class="p">:</span> <span class="p">[</span> <span class="nx">esParameters</span><span class="p">.</span><span class="nx">status</span> <span class="p">],</span>
            <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
                <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">status</span><span class="p">]:</span> <span class="p">{</span>
                    <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span><span class="p">,</span> <span class="s2">"array"</span> <span class="p">],</span>
                    <span class="na">defaultValue</span><span class="p">:</span> <span class="p">{</span>
                        <span class="na">operand</span><span class="p">:</span> <span class="s2">"not"</span><span class="p">,</span>
                        <span class="na">value</span><span class="p">:</span> <span class="p">[</span>
                            <span class="s2">"Vendu"</span><span class="p">,</span>
                            <span class="s2">"Compromis"</span><span class="p">,</span>
                            <span class="s2">"Suspendu"</span><span class="p">,</span>
                        <span class="p">]</span>
                    <span class="p">},</span>
                    <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
                        <span class="na">strict</span><span class="p">:</span> <span class="kc">true</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>We can send an empty query, and get all data where the status is <strong>NOT</strong> <code>Vendu</code> <strong>NOR</strong> <code>Compromis</code> <strong>NOR</strong> <code>Suspendu</code>.</p>
<h2 id='advanced-example'>Advanced example</h2>
<p>For nested objects, we can add <code>notIncludedInES</code>.</p>

<p>It will prevent the search against that field.</p>

<p>In order to have a search againsit fields that are included in <code>location</code>, we can add a <code>fields</code> parameter to list all the searchable fields.</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="na">terms</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">keys</span><span class="p">:</span> <span class="p">[</span> <span class="nx">esParameters</span><span class="p">.</span><span class="nx">location</span> <span class="p">],</span>
            <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
                <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">location</span><span class="p">]:</span> <span class="p">{</span>
                    <span class="na">notIncludedInES</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="na">shouldBetweenTerms</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="na">fields</span><span class="p">:</span> <span class="p">[</span>
                        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">zipCode</span><span class="p">,</span>
                        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">cityName</span><span class="p">,</span>
                        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">departmentName</span><span class="p">,</span>
                        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">regionName</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>We can send a query like:</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">location</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">zip_code</span><span class="p">:</span> <span class="mi">14000</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>A <code>shouldBetweenTerms</code> parameter can be set in order to get a logical OR between terms.</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="na">terms</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">keys</span><span class="p">:</span> <span class="p">[</span> <span class="nx">esParameters</span><span class="p">.</span><span class="nx">location</span> <span class="p">],</span>
            <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
                <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">location</span><span class="p">]:</span> <span class="p">{</span>
                    <span class="na">notIncludedInES</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="na">shouldBetweenTerms</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="na">fields</span><span class="p">:</span> <span class="p">[</span>
                        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">zipCode</span><span class="p">,</span>
                        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">cityName</span><span class="p">,</span>
                        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">departmentName</span><span class="p">,</span>
                        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">regionName</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>We can send a query like:</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">location</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">zip_code</span><span class="p">:</span> <span class="mi">14000</span><span class="p">,</span>
        <span class="nx">city_name</span><span class="p">:</span> <span class="s2">"Saint Aubin Sur mer"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>It will return all the data with <code>&quot;14000&quot;</code> as <code>zip_code</code>, <strong>OR</strong> <code>&quot;Saint Aubin Sur mer&quot;</code> as <code>city_name</code>.</p>

<p>Additionnal options can be passed to fields that are nested.</p>

<p>For example, the <code>location</code> field is a nested object with a <code>zip_code</code> field.</p>

<p>A <code>strict</code> option can be used to get an exact match aganst the <code>zip_code</code> value.</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="na">terms</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">keys</span><span class="p">:</span> <span class="p">[</span> <span class="nx">esParameters</span><span class="p">.</span><span class="nx">location</span> <span class="p">],</span>
            <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
                <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">location</span><span class="p">]:</span> <span class="p">{</span>
                    <span class="na">notIncludedInES</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="na">shouldBetweenTerms</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="na">fields</span><span class="p">:</span> <span class="p">[</span>
                        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">zipCode</span><span class="p">,</span>
                        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">cityName</span><span class="p">,</span>
                        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">departmentName</span><span class="p">,</span>
                        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">regionName</span>
                    <span class="p">]</span>
                <span class="p">},</span>
                <span class="na">zip_code</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">strict</span><span class="p">:</span> <span class="kc">true</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>To override the default query used to trigger Elasticsearch database, we can add a <code>query</code> option (default is <code>term</code>).</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="na">terms</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">keys</span><span class="p">:</span> <span class="p">[</span> <span class="nx">esParameters</span><span class="p">.</span><span class="nx">location</span> <span class="p">],</span>
            <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
                <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">location</span><span class="p">]:</span> <span class="p">{</span>
                    <span class="na">notIncludedInES</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="na">shouldBetweenTerms</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="na">fields</span><span class="p">:</span> <span class="p">[</span>
                        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">zipCode</span><span class="p">,</span>
                        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">cityName</span><span class="p">,</span>
                        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">departmentName</span><span class="p">,</span>
                        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">regionName</span>
                    <span class="p">]</span>
                <span class="p">},</span>
                <span class="na">zip_code</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">strict</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="na">query</span><span class="p">:</span> <span class="s2">"terms"</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><h1 id='from-and-size'>From and size</h1>
<p>The <code>from</code> and <code>size</code> parameters are used for pagination.</p>

<p>The <code>from</code> value will fix from wich element we&#39;ll send the results.</p>

<p>The <code>size</code> value if for the number of elements in the results.</p>
<pre class="highlight javascript tab-javascript"><code><span class="nx">from</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span><span class="p">,</span> <span class="s2">"number"</span> <span class="p">]</span>
<span class="p">}</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="nx">size</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span><span class="p">,</span> <span class="s2">"number"</span> <span class="p">]</span>
<span class="p">}</span>
</code></pre>
<p>We can then send queries like:
```javascript
{
    from: 100,
    size: 100
}</p>
<pre class="highlight plaintext"><code>

# Sort

## Basic structure

The `sort` parameter is used for sorting results.

The basic structure is:

```javascript
const esIndexes = {
    [tablesNameES.properties]: {
        [esParameters.sort]: {
            correctTypes: [ "object", "array" ],
            correctParameters: {
                attribute: {
                    correctTypes: [ "string" ]
                },
                order: {
                    correctTypes: [ "string" ],
                    correctValues: [ "asc", "desc" ],
                    defaultValue: "desc"
                }
            }
        }
    }
}
</code></pre>
<p>We can then send queries like:
<code>javascript
sort: {
    attribute: &quot;price&quot;,
    order: &quot;asc&quot;
}
</code></p>
<h2 id='script-parameter'>Script parameter</h2>
<p>The <code>script</code> parameter allow the query to contain a painless script, in order to sort results from data values.</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">sort</span><span class="p">]:</span> <span class="p">{</span>
            <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"object"</span><span class="p">,</span> <span class="s2">"array"</span> <span class="p">],</span>
            <span class="na">correctParameters</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">script</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"object"</span> <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>For example, to sort accordingly to the <code>exclusif</code> value in the results, we can do the following:</p>
<pre class="highlight javascript tab-javascript"><code><span class="nx">sort</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">script</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">lang</span><span class="p">:</span> <span class="s2">"painless"</span><span class="p">,</span>
        <span class="nx">inline</span><span class="p">:</span> <span class="s2">"_score * (doc['exclusivif'].value * 5 + 1)"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>This is some <strong>fine art</strong> to get the item result, and multiply it by a factor that depends on the exclusivity value (0 or 1).</p>

<p><em>Some people get hired at Nasa for less than that.</em></p>
<h1 id='location'>Location</h1><h2 id='basic-structure-2'>Basic structure</h2>
<p>The <code>location</code> object contains all the location queries.</p>

<p>The <code>correctParameters</code> for the ocation queries can be one of the following:</p>

<ul>
<li><code>travel_time</code></li>
<li><code>starting_coord</code></li>
<li><code>starting_city</code></li>
<li><code>bound_box</code></li>
<li><code>polygons</code></li>
<li><code>zip_code</code></li>
<li><code>city_name</code></li>
<li><code>city_name_with_zip</code></li>
<li><code>city_name_and_around</code></li>
<li><code>departement_name</code></li>
<li><code>departement_code</code></li>
<li><code>region_name</code></li>
<li><code>region_new_name</code></li>
</ul>

<p>Thus, the main structure for the location config is the following:</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">location</span><span class="p">]:</span> <span class="p">{</span>
            <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"object"</span><span class="p">,</span> <span class="s2">"array"</span> <span class="p">],</span>
            <span class="na">correctParameters</span><span class="p">:</span> <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><h2 id='gauss-parameter'>Gauss parameter</h2>
<p>The <code>gauss</code> parameter is used for the locatlisation functon.</p>

<p>The config is as follow:</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">scale</span><span class="p">:</span> <span class="s2">"5km"</span><span class="p">,</span>
    <span class="nx">offset</span><span class="p">:</span> <span class="s2">"1km"</span><span class="p">,</span>
    <span class="nx">decay</span><span class="p">:</span> <span class="mf">0.7</span>
<span class="p">};</span>
</code></pre>
<p>The <code>scale</code> parameter represents the for how much distance as unit of decrease.</p>

<p>The <code>offset</code> parameter represents an offset from which we&#39;ll start the decrease.</p>

<p>The <code>decay</code> parameter is a factor to decrease the item score.</p>

<p>For example:</p>

<ul>
<li>an item has a score of <code>100</code></li>
<li>it is located at <code>7km</code> from the requested point</li>
<li>with the config the final score will be <code>70</code></li>
</ul>
<h2 id='travel-time'>Travel time</h2>
<p>The <code>travel time</code> query needs a field name in order to select on which field the query will be run against:</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">location</span><span class="p">]:</span> <span class="p">{</span>
            <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"object"</span><span class="p">,</span> <span class="s2">"array"</span> <span class="p">],</span>
            <span class="na">correctParameters</span><span class="p">:</span> <span class="p">{</span>
                <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">travelTime</span><span class="p">]:</span> <span class="p">{</span>
                    <span class="na">field</span><span class="p">:</span> <span class="s2">"itemLocation"</span><span class="p">,</span>
                    <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"object"</span><span class="p">,</span> <span class="s2">"array"</span> <span class="p">],</span>
                    <span class="na">correctParameters</span><span class="p">:</span> <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>We can send multiple parameters from the following:</p>

<ul>
<li><code>mode</code></li>
<li><code>travel</code></li>
<li><code>traffic</code></li>
<li><code>routeWeights</code></li>
<li><code>quality</code></li>
<li><code>range</code></li>
<li><code>rangeType</code></li>
<li><code>coordinates</code></li>
<li><code>startingCity</code></li>
</ul>

<p><em>The following code examples will be inside <code>correctParameters</code></em></p>

<p>The <code>mode</code> parameter is for the transport mode (5 in total).</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">mode</span><span class="p">]:</span> <span class="p">{</span>
    <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span> <span class="p">],</span>
    <span class="nx">correctValues</span><span class="p">:</span> <span class="p">[</span>
        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">car</span><span class="p">,</span>
        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">pedestrian</span><span class="p">,</span>
        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">publicTransport</span><span class="p">,</span>
        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">bike</span><span class="p">,</span>
        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">truck</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre>
<p>The <code>travel</code> parameter is for the travel method (3 in total):</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">travel</span><span class="p">]:</span> <span class="p">{</span>
    <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span> <span class="p">],</span>
    <span class="nx">correctValues</span><span class="p">:</span> <span class="p">[</span>
        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">shortest</span><span class="p">,</span>
        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">fastest</span><span class="p">,</span>
        <span class="nx">esParameters</span><span class="p">.</span><span class="k">default</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">traffic</span><span class="p">]:</span> <span class="p">{</span>
    <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span><span class="p">,</span> <span class="s2">"boolean"</span> <span class="p">],</span>
    <span class="nx">correctValues</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"true"</span><span class="p">,</span> <span class="s2">"false"</span> <span class="p">]</span>
<span class="p">},</span>
</code></pre>
<p>The <code>routeWeights</code> parameter allow the sender to add weights on the routes (<code>0</code> = default, <code>-3</code> = avoid as much as possible).</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">routeWeights</span><span class="p">]:</span> <span class="p">{</span>
    <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"object"</span> <span class="p">],</span>
    <span class="nx">correctParameters</span><span class="p">:</span> <span class="p">{</span>
        <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">tollroad</span><span class="p">]:</span> <span class="p">{</span>
            <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span><span class="p">,</span> <span class="s2">"number"</span> <span class="p">],</span>
            <span class="nx">correctValues</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"0"</span><span class="p">,</span> <span class="s2">"-1"</span><span class="p">,</span> <span class="s2">"-2"</span><span class="p">,</span> <span class="s2">"-3"</span> <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">motorway</span><span class="p">]:</span> <span class="p">{</span>
            <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span><span class="p">,</span> <span class="s2">"number"</span> <span class="p">],</span>
            <span class="nx">correctValues</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"0"</span><span class="p">,</span> <span class="s2">"-1"</span><span class="p">,</span> <span class="s2">"-2"</span><span class="p">,</span> <span class="s2">"-3"</span> <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">boatFerry</span><span class="p">]:</span> <span class="p">{</span>
            <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span><span class="p">,</span> <span class="s2">"number"</span> <span class="p">],</span>
            <span class="nx">correctValues</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"0"</span><span class="p">,</span> <span class="s2">"-1"</span><span class="p">,</span> <span class="s2">"-2"</span><span class="p">,</span> <span class="s2">"-3"</span> <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">railFerry</span><span class="p">]:</span> <span class="p">{</span>
            <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span><span class="p">,</span> <span class="s2">"number"</span> <span class="p">],</span>
            <span class="nx">correctValues</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"0"</span><span class="p">,</span> <span class="s2">"-1"</span><span class="p">,</span> <span class="s2">"-2"</span><span class="p">,</span> <span class="s2">"-3"</span> <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">tunnel</span><span class="p">]:</span> <span class="p">{</span>
            <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span><span class="p">,</span> <span class="s2">"number"</span> <span class="p">],</span>
            <span class="nx">correctValues</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"0"</span><span class="p">,</span> <span class="s2">"-1"</span><span class="p">,</span> <span class="s2">"-2"</span><span class="p">,</span> <span class="s2">"-3"</span> <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">dirtRoad</span><span class="p">]:</span> <span class="p">{</span>
            <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span><span class="p">,</span> <span class="s2">"number"</span> <span class="p">],</span>
            <span class="nx">correctValues</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"0"</span><span class="p">,</span> <span class="s2">"-1"</span><span class="p">,</span> <span class="s2">"-2"</span><span class="p">,</span> <span class="s2">"-3"</span> <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">park</span><span class="p">]:</span> <span class="p">{</span>
            <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span><span class="p">,</span> <span class="s2">"number"</span> <span class="p">],</span>
            <span class="nx">correctValues</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"0"</span><span class="p">,</span> <span class="s2">"-1"</span><span class="p">,</span> <span class="s2">"-2"</span><span class="p">,</span> <span class="s2">"-3"</span> <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>The <code>quality</code> parameter is used for the isoline shape quality.</p>

<p>The higher the value, the better the quality is but longer will be the calculation.</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">quality</span><span class="p">]:</span> <span class="p">{</span>
    <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span><span class="p">,</span> <span class="s2">"number"</span> <span class="p">],</span>
    <span class="nx">correctValues</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"1"</span><span class="p">,</span> <span class="s2">"2"</span><span class="p">,</span> <span class="s2">"3"</span> <span class="p">]</span>
<span class="p">},</span>
</code></pre>
<p>The <code>rangeType</code> parameter is used as range value, as distance or time.</p>

<p>The maximum is <code>32400</code>.</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">range</span><span class="p">]:</span> <span class="p">{</span>
    <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"number"</span> <span class="p">],</span>
    <span class="nx">max</span><span class="p">:</span> <span class="mi">32400</span>
<span class="p">}</span>
</code></pre>
<p>The <code>rangeType</code> parameter is used with the <code>range</code> parameter.</p>

<p>It will defin de type of value that <code>range</code> will represent (<code>distance in meters</code>, or <code>time in seconds</code>).</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">rangeType</span><span class="p">]:</span> <span class="p">{</span>
    <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span> <span class="p">],</span>
    <span class="nx">correctValues</span><span class="p">:</span> <span class="p">[</span>
        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">distance</span><span class="p">,</span>
        <span class="nx">esParameters</span><span class="p">.</span><span class="nx">time</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre>
<p>As starting point, we can set <code>coordinates</code> or <code>startingCity</code>.</p>

<p><code>coordinates</code> can be sent as <code>string</code>, <code>array of points</code> or <code>object with lat and lon</code>.</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">coordinates</span><span class="p">]:</span> <span class="p">{</span>
    <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span><span class="p">,</span> <span class="s2">"array"</span><span class="p">,</span> <span class="s2">"object"</span> <span class="p">],</span>
    <span class="nx">correctParameters</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">lat</span><span class="p">:</span> <span class="p">{</span>
            <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"number"</span><span class="p">,</span> <span class="s2">"string"</span> <span class="p">]</span>
        <span class="p">},</span>
        <span class="nx">lon</span><span class="p">:</span> <span class="p">{</span>
            <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"number"</span><span class="p">,</span> <span class="s2">"string"</span> <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>For example:</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="p">...,</span>
    <span class="nx">coordinates</span><span class="p">:</span> <span class="s2">"49.1846358,-0.4072621"</span>
<span class="p">}</span>

<span class="p">{</span>
    <span class="p">...,</span>
    <span class="nx">coordinates</span><span class="p">:</span> <span class="p">[</span><span class="s2">"49.1846358"</span><span class="p">,</span> <span class="s2">"-0.4072621"</span><span class="p">]</span>
<span class="p">}</span>

<span class="p">{</span>
    <span class="p">...,</span>
    <span class="nx">coordinates</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">lat</span><span class="p">:</span> <span class="s2">"49.1846358"</span><span class="p">,</span>
        <span class="nx">lon</span><span class="p">:</span> <span class="s2">"-0.4072621"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>The other starting option can be <code>startingCity</code>.</p>

<p>The string will be geolocalized, and the coordinates will be used as starting point.</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">startingCity</span><span class="p">]:</span> <span class="p">{</span>
    <span class="nl">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span><span class="p">,</span> <span class="s2">"array"</span> <span class="p">]</span>
<span class="p">}</span>
</code></pre><h2 id='starting-coordinates'>Starting coordinates</h2>
<p>The <code>startingCoordinates</code> option is used to get all items from one point.</p>

<p>The more they are close to this point, the sooner they will appear in the results.</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">location</span><span class="p">]:</span> <span class="p">{</span>
            <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"object"</span><span class="p">,</span> <span class="s2">"array"</span> <span class="p">],</span>
            <span class="na">correctParameters</span><span class="p">:</span> <span class="p">{</span>
                <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">startingCoordinates</span><span class="p">]:</span> <span class="p">{</span>
                    <span class="na">fields</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"itemLocation"</span> <span class="p">]</span>
                    <span class="na">coordinates</span><span class="p">:</span> <span class="p">{</span>
                        <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span><span class="p">,</span> <span class="s2">"array"</span><span class="p">,</span> <span class="s2">"object"</span> <span class="p">],</span>
                        <span class="na">correctParameters</span><span class="p">:</span> <span class="p">{</span>
                            <span class="na">lat</span><span class="p">:</span> <span class="p">{</span>
                                <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"number"</span><span class="p">,</span> <span class="s2">"string"</span> <span class="p">]</span>
                            <span class="p">},</span>
                            <span class="na">lon</span><span class="p">:</span> <span class="p">{</span>
                                <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"number"</span><span class="p">,</span> <span class="s2">"string"</span> <span class="p">]</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">},</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>We can send a query like:</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">starting_coordinates</span><span class="p">:</span> <span class="s2">"49.1846358,-0.4072621"</span>
<span class="p">}</span>

<span class="p">{</span>
    <span class="nl">starting_coordinates</span><span class="p">:</span> <span class="p">[</span><span class="s2">"49.1846358"</span><span class="p">,</span> <span class="s2">"-0.4072621"</span><span class="p">]</span>
<span class="p">}</span>

<span class="p">{</span>
    <span class="nl">starting_coordinates</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">lat</span><span class="p">:</span> <span class="s2">"49.1846358"</span><span class="p">,</span>
        <span class="nx">lon</span><span class="p">:</span> <span class="s2">"-0.4072621"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><h2 id='starting-city'>Starting city</h2>
<p>The same logic as in <code>startingCoordinates</code> is applied with the <code>startingCity</code>.</p>

<p>The more they are close to the geolocalized point from the city name, the sooner they will appear in the results.</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">location</span><span class="p">]:</span> <span class="p">{</span>
            <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"object"</span><span class="p">,</span> <span class="s2">"array"</span> <span class="p">],</span>
            <span class="na">correctParameters</span><span class="p">:</span> <span class="p">{</span>
                <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">startingCity</span><span class="p">]:</span> <span class="p">{</span>
                    <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"string"</span><span class="p">,</span> <span class="s2">"array"</span> <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>We can send a query like:</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">starting_city</span><span class="p">:</span> <span class="s2">"Caen"</span>
<span class="p">}</span>
</code></pre><h2 id='bound-box'>Bound box</h2>
<p>The <code>boundBox</code> option is used for queries with <code>east</code>, <code>west</code>, <code>north</code>, and <code>south</code> values (for examples with maps that send the four values, in order to get results inside that map).</p>

<p>The four points (<code>NE</code>, <code>NW</code>, <code>SE</code>, <code>SW</code>) will be construct with these values.</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">location</span><span class="p">]:</span> <span class="p">{</span>
            <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"object"</span> <span class="p">],</span>
            <span class="na">correctParameters</span><span class="p">:</span> <span class="p">{</span>
                <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">boundBox</span><span class="p">]:</span> <span class="p">{</span>
                    <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"object"</span> <span class="p">],</span>
                    <span class="na">correctParameters</span><span class="p">:</span> <span class="p">{</span>
                            <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">east</span><span class="p">]:</span> <span class="p">{</span>
                                <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"number"</span><span class="p">,</span> <span class="s2">"string"</span> <span class="p">]</span>
                            <span class="p">},</span>
                            <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">west</span><span class="p">]:</span> <span class="p">{</span>
                                <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"number"</span><span class="p">,</span> <span class="s2">"string"</span> <span class="p">]</span>
                            <span class="p">},</span>
                            <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">north</span><span class="p">]:</span> <span class="p">{</span>
                                <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"number"</span><span class="p">,</span> <span class="s2">"string"</span> <span class="p">]</span>
                            <span class="p">},</span>
                            <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">south</span><span class="p">]:</span> <span class="p">{</span>
                                <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"number"</span><span class="p">,</span> <span class="s2">"string"</span> <span class="p">]</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre>
<p>We can send a query like:</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">bound_box</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"east"</span><span class="p">:</span> <span class="mf">2.157515186732553</span><span class="p">,</span>
        <span class="s2">"west"</span><span class="p">:</span> <span class="mf">1.410444874232553</span><span class="p">,</span>
        <span class="s2">"north"</span><span class="p">:</span> <span class="mf">49.21119368510827</span><span class="p">,</span>
        <span class="s2">"south"</span><span class="p">:</span> <span class="mf">48.40081833276716</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><h2 id='polygons'>Polygons</h2>
<p>The <code>points</code> option can be used to get items inside a polygon made with several polygons.</p>

<p>One polygon is a list of points.</p>

<p><code>points</code> can handle an array of polygons.</p>

<p>The structure is as following:</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">[</span>
    <span class="p">[</span>
        <span class="p">{</span> <span class="p">...</span> <span class="p">},</span>
        <span class="p">{</span> <span class="p">...</span> <span class="p">},</span>
        <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="p">{</span> <span class="p">...</span> <span class="p">},</span>
        <span class="p">{</span> <span class="p">...</span> <span class="p">},</span>
        <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>
    <span class="p">]</span>
<span class="p">]</span>
</code></pre>
<p>The correct settings are simple, but must includes <code>object</code> and <code>array</code> as correct type.</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">esIndexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">tablesNameES</span><span class="p">.</span><span class="nx">properties</span><span class="p">]:</span> <span class="p">{</span>
        <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">location</span><span class="p">]:</span> <span class="p">{</span>
            <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"object"</span> <span class="p">],</span>
            <span class="na">correctParameters</span><span class="p">:</span> <span class="p">{</span>
                <span class="p">[</span><span class="nx">esParameters</span><span class="p">.</span><span class="nx">polygons</span><span class="p">]:</span> <span class="p">{</span>
                    <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"object"</span><span class="p">,</span> <span class="s2">"array"</span> <span class="p">],</span>
                    <span class="na">correctParameters</span><span class="p">:</span> <span class="p">{</span>
                        <span class="na">lat</span><span class="p">:</span> <span class="p">{</span>
                            <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"number"</span><span class="p">,</span> <span class="s2">"string"</span> <span class="p">]</span>
                        <span class="p">},</span>
                        <span class="na">lon</span><span class="p">:</span> <span class="p">{</span>
                            <span class="na">correctTypes</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"number"</span><span class="p">,</span> <span class="s2">"string"</span> <span class="p">]</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><h1 id='associations'>Associations</h1>
<p>It is possible to add assocaitions, in order to query multiple values from one query.</p>

<p>For example, the postal code of Paris 16 can be either <code>75016</code> or <code>75116</code>.</p>

<p>If a query contains <code>75016</code>, it will also search 75116 as postal code with a OR query.</p>

<p>The config is as following:</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">associations</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">zip_code</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span> <span class="s2">"75016"</span><span class="p">,</span> <span class="s2">"75116"</span> <span class="p">]</span>
    <span class="p">]</span>
<span class="p">};</span>
</code></pre>
<p>We can send a query like:</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">zip_code</span><span class="p">:</span> <span class="s2">"75016"</span>
<span class="p">}</span>
</code></pre>
<p>It will be the same as if we send a query like:</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">zip_code</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"75016"</span><span class="p">,</span> <span class="s2">"75116"</span> <span class="p">]</span>
<span class="p">}</span>
</code></pre><h1 id='synonyms'>Synonyms</h1>
<p>It is possible to add synonyms in order to replace some requested values.</p>

<p>The structure is as following:</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">synonyms</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">FIELD_NAME</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">WORD</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">...</span><span class="nx">SYNONYMS</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>For example, we can add synonyms for estate types:</p>
<pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">synonyms</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">type_bien</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">Maison</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">"Maison"</span><span class="p">,</span>
            <span class="s2">"Villa"</span>
        <span class="p">],</span>
        <span class="na">Appartement</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">"Appartement"</span><span class="p">,</span>
            <span class="s2">"Loft"</span><span class="p">,</span>
            <span class="s2">"Marina"</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>We can send a query like:</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">type_bien</span><span class="p">:</span> <span class="s2">"Maison"</span>
<span class="p">}</span>
</code></pre>
<p>It will be the same as if we send a query like:</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">type_bien</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"Maison"</span><span class="p">,</span> <span class="s2">"Villa"</span> <span class="p">]</span>
<span class="p">}</span>
</code></pre><h1 id='settings'>Settings</h1>
<p>The <code>esSettings</code> function purpose is to retrieve the ES settings for indexes, as following:</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">settings</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">analysis</span><span class="p">:</span> <span class="p">{</span>
            <span class="nl">filter</span><span class="p">:</span> <span class="p">{</span>
                <span class="nl">french_elision</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nl">type</span><span class="p">:</span> <span class="s2">"elision"</span><span class="p">,</span>
                    <span class="nx">articles_case</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="nx">articles</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">"l"</span><span class="p">,</span> <span class="s2">"m"</span><span class="p">,</span> <span class="s2">"t"</span><span class="p">,</span> <span class="s2">"qu"</span><span class="p">,</span> <span class="s2">"n"</span><span class="p">,</span> <span class="s2">"s"</span><span class="p">,</span>
                        <span class="s2">"j"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="s2">"jusqu"</span><span class="p">,</span> <span class="s2">"quoiqu"</span><span class="p">,</span>
                        <span class="s2">"lorsqu"</span><span class="p">,</span> <span class="s2">"puisqu"</span>
                    <span class="p">]</span>
                <span class="p">},</span>
                <span class="nx">french_stop</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nl">type</span><span class="p">:</span> <span class="s2">"stop"</span><span class="p">,</span>
                    <span class="nx">stopwords</span><span class="p">:</span> <span class="s2">"_french_"</span>
                <span class="p">},</span>
                <span class="nx">french_stemmer</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nl">type</span><span class="p">:</span> <span class="s2">"stemmer"</span><span class="p">,</span>
                    <span class="nx">language</span><span class="p">:</span> <span class="s2">"light_french"</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="nx">tokenizer</span><span class="p">:</span> <span class="p">{</span>
                <span class="nl">location_tokenizer</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nl">type</span><span class="p">:</span> <span class="s2">"pattern"</span><span class="p">,</span>
                    <span class="nx">pattern</span><span class="p">:</span> <span class="s2">"[^a-zA-Z0-9-]+"</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="nx">analyzer</span><span class="p">:</span> <span class="p">{</span>
                <span class="nl">french</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nl">tokenizer</span><span class="p">:</span> <span class="s2">"icu_tokenizer"</span><span class="p">,</span>
                    <span class="nx">filter</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">"french_stop"</span><span class="p">,</span>
                        <span class="s2">"french_elision"</span><span class="p">,</span>
                        <span class="s2">"lowercase"</span><span class="p">,</span>
                        <span class="s2">"icu_folding"</span><span class="p">,</span>
                        <span class="s2">"french_stemmer"</span>
                    <span class="p">];</span>
                <span class="p">},</span>
                <span class="nx">location_analyzer</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nl">type</span><span class="p">:</span> <span class="s2">"custom"</span><span class="p">,</span>
                    <span class="nx">tokenizer</span><span class="p">:</span> <span class="s2">"location_tokenizer"</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">max_result_window</span><span class="p">:</span> <span class="mi">100000</span>
<span class="p">}</span>
</code></pre>
<p>It is used to initialiaze <code>filters</code>, <code>tokenizer</code> and <code>analyzer</code>.</p>

<p>It can have some <code>synonyms</code> in parameter (from the Backoffice or from a specific file).</p>
<h2 id='filters'>Filters</h2>
<p>Filters are set as following:</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">french_elision</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">type</span><span class="p">:</span> <span class="s2">"elision"</span><span class="p">,</span>
        <span class="nx">articles_case</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">articles</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">"l"</span><span class="p">,</span> <span class="s2">"m"</span><span class="p">,</span> <span class="s2">"t"</span><span class="p">,</span> <span class="s2">"qu"</span><span class="p">,</span> <span class="s2">"n"</span><span class="p">,</span> <span class="s2">"s"</span><span class="p">,</span>
            <span class="s2">"j"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="s2">"jusqu"</span><span class="p">,</span> <span class="s2">"quoiqu"</span><span class="p">,</span>
            <span class="s2">"lorsqu"</span><span class="p">,</span> <span class="s2">"puisqu"</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="nx">french_stop</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">type</span><span class="p">:</span> <span class="s2">"stop"</span><span class="p">,</span>
        <span class="nx">stopwords</span><span class="p">:</span> <span class="s2">"_french_"</span>
    <span class="p">},</span>
    <span class="nx">french_stemmer</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">type</span><span class="p">:</span> <span class="s2">"stemmer"</span><span class="p">,</span>
        <span class="nx">language</span><span class="p">:</span> <span class="s2">"light_french"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<ul>
<li><code>french_elision</code> will be used to remove some words</li>
<li><code>french_stop</code> will be used for french stop words = words that will not be taken into account</li>
<li><code>french_stemmer</code> will be used for word stemming = get words root</li>
</ul>

<p>These filters will be used against all the <code>data that will be indexed into ES</code>, and against the <code>values passed in the query</code>.</p>
<h2 id='analyzer'>Analyzer</h2>
<p>The analyzers will help to process the indexed data and the requested values.</p>

<p>It uses all the filters previously defined.</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">french</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">tokenizer</span><span class="p">:</span> <span class="s2">"icu_tokenizer"</span><span class="p">,</span>
        <span class="nx">filter</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">"french_stop"</span><span class="p">,</span>
            <span class="s2">"french_elision"</span><span class="p">,</span>
            <span class="s2">"lowercase"</span><span class="p">,</span>
            <span class="s2">"icu_folding"</span><span class="p">,</span>
            <span class="s2">"french_stemmer"</span>
        <span class="p">];</span>
    <span class="p">},</span>
    <span class="nx">location_analyzer</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">type</span><span class="p">:</span> <span class="s2">"custom"</span><span class="p">,</span>
        <span class="nx">tokenizer</span><span class="p">:</span> <span class="s2">"location_tokenizer"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><h2 id='synonyms-2'>Synonyms</h2>
<p>Synonyms from the Backoffice can be passed from the parameters.</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">synonym_filter</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">type</span><span class="p">:</span> <span class="s2">"synonym_graph"</span><span class="p">,</span>
        <span class="nx">ignore_case</span><span class="p">:</span> <span class="s2">"true"</span><span class="p">,</span>
        <span class="nx">lenient</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">synonyms</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>A synonym filter needs to be added and used in the config.</p>
<h1 id='schema'>Schema</h1><h2 id='general-structure'>General structure</h2>
<p><img src="images/api-archi-e1f4bebb.jpeg" alt="api-gateway" /></p>
<h2 id='api-fw-architecture'>API FW architecture</h2>
<p><img src="images/api-fw-archi-f9df0001.jpeg" alt="api-gateway" /></p>
<h1 id='api-gateway'>API Gateway</h1><h2 id='api-gateway-architecture'>API Gateway architecture</h2>
<p><img src="images/api-gateway-archi-a8a4b0a8.jpeg" alt="api-gateway" /></p>
<h2 id='method-request'>Method Request</h2>
<p>The <code>API Key REquired</code> must be set to <code>true</code></p>
<h2 id='integration-request'>Integration Request</h2>
<p>Choose the corect lambda function to call.</p>

<p>It must be called <strong>without</strong> <code>Use Lambda Proxy integration</code>.</p>

<p>The content type is <code>application/json</code>.</p>

<p>The mapping templates should be as follow:</p>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="err">$input.json('$')</span><span class="p">,</span><span class="w">
    </span><span class="s2">"resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$context.resourcePath"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"queryStringParameters"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="err">#foreach($param</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="err">$input.params().querystring.keySet())</span><span class="w">
            </span><span class="s2">"$param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$util.escapeJavaScript($input.params().querystring.get($param))"</span><span class="w"> </span><span class="err">#if($foreach.hasNext)</span><span class="p">,</span><span class="err">#end</span><span class="w">
        </span><span class="err">#end</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h2 id='method-responses'>Method Responses</h2>
<p>Before setting up the <code>Integration Responses</code>, you need to configure the <code>Method Responses</code>.</p>

<p>Configure the correct <code>HTTP Status</code>:</p>

<ul>
<li>200</li>
<li>500</li>
</ul>
<h2 id='integration-responses'>Integration Responses</h2>
<ul>
<li>Default

<ul>
<li>Lambda Error Regex: -</li>
<li>Method response stauts: 200</li>
<li>Content handling: Passthrough</li>
<li>Mapping templates:

<ul>
<li>content type: application/json</li>
<li>template:</li>
</ul></li>
</ul></li>
</ul>
<pre class="highlight json tab-json"><code><span class="err">$input.path(</span><span class="s2">"$.body"</span><span class="err">)</span><span class="w">
</span></code></pre>
<ul>
<li>Error

<ul>
<li>Lambda Error Regex: Error.*</li>
<li>Method response stauts: 500</li>
<li>Content handling: Passthrough</li>
<li>Mapping templates:

<ul>
<li>content type: application/json</li>
<li>template:</li>
</ul></li>
</ul></li>
</ul>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> </span><span class="s2">"error"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="err">$input.json(</span><span class="s2">"$.errorMessage"</span><span class="err">)</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre>
      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
